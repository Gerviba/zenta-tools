#!/usr/bin/python

import jira
import sys

conn = jira.JIRA(dict(server=sys.argv[1], verify=False))

issues = conn.search_issues(sys.argv[2])
print "<issues>"
for issue in issues:
    print ' <issue id="{0}" status="{1}">'.format(
        issue.id,
        issue.fields.status.name.encode('utf-8'))
    print '  <summary>{0}</summary>'.format(
        issue.fields.summary.encode('utf-8'))
    links = conn.remote_links(issue)
    for link in links:
        print '  <link url="{0}" title="{1}"/>'.format(
            link.object.url.encode('utf-8'),
            link.object.title.encode('utf-8'))
    print "</issue>"
print "</issues>"
